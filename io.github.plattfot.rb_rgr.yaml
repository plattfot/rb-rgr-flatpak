id: io.github.plattfot.rb_rgr
runtime: org.freedesktop.Platform
runtime-version: '21.08'
sdk: org.freedesktop.Sdk
command: rgr
modules:
  - name: rgreceiver
    buildsystem: simple
    build-commands:
      - pwd
      - tar -xf receiver/rg_install_receiver_rpm.tar.gz
      - bsdtar xf *.rpm
      - install -m644 -D LICENSE.txt "/app/share/licenses/rgreceiver/LICENSE"
      # copy the directories
      - find ./opt ./etc ./usr -type f -exec install -vDm 755 {} /app/{} \;
      # install executable in /bin
      - install -dm755 /app/bin
      - echo -e "#!/bin/bash\n/app/opt/hpremote/rgreceiver/rgreceiver.sh" > /app/bin/rgr
      - chmod 755 /app/bin/rgr
    sources:
      - type: archive
        path: ZCentral_RB_22.0_Linux_Receiver_M39127-007.tar.gz
finish-args:
  # X11 + XShm access
  - --share=ipc
  - --socket=x11
  # Needs to talk to the network:
  - --share=network
  # OpenGL rendering
  - --device=dri
  # Does not handle wayland
  - --unset-env=QT_QPA_PLATFORM
  # Point it to where it can find the libs
  - --env=LD_LIBRARY_PATH=/app/opt/hpremote/rgreceiver/lib64
